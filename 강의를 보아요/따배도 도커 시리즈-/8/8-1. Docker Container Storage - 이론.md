# Docker Container Storage
## Container Volume
- 컨테이너 이미지는 read only 로 수정할 수 없음.
- 컨테이너에 추가되는 데이터는 별도의 read write 레이어에 저장됨.

> Union File System (overlay) </br>
도커에서 여러 레이어를 합쳐서 하나의 통합된 파일시스템처럼 보이게 하는 것. </br>
ro 레이어와 rw 레이어가 하나인 것처럼 실행됨.

컨테이너를 삭제하면 그 안에 추가된 데이터도 함께 사라지므로, 데이터를 유지하려면 별도로 보존할 방법이 필요

## 데이터 보존
컨테이너에서 생성된 데이터를 Docker Host 에 저장할 수 있음

```sh
docker run -v <호스트_경로>:<컨테이너_경로> [이미지명]

docker run -v <컨테이너_마운트_경로> [이미지명]] # 임의의 디렉토리에 마운트

# 예시
docker run -d \
  --name my-mysql \
  -e MYSQL_ROOT_PASSWORD=1234 \
  -v /home/mysql_data:/var/lib/mysql \
  mysql:8.0
```

- <호스트_경로>: 내 로컬(호스트) 컴퓨터의 경로
- <컨테이너_경로>: 컨테이너 내부에서 접근할 경로
- 선택적으로 :ro 또는 :rw 옵션을 붙일 수 있음
    - :ro → read-only (읽기 전용)
        - ✅ 데이터 참조용 컨테이너 : 백업된 DB 파일을 분석하거나 확인만 할 때
        - ✅ 보안 목적 : 컨테이너가 실수로 호스트의 설정 파일을 수정하지 못하게 할 때
        - ✅ 웹 서버 정적 파일 제공 : Nginx, Apache 컨테이너가 HTML 파일만 읽게 하고, 수정은 못하게 할 때
    - :rw → read-write (기본값, 읽기/쓰기 가능)

## 컨테이너간 데이터 공유
- 동일한 호스트 경로에 대해 마운트하여 컨테이너간 데이터 공유할 수 있음.
- 웹서버는 컨테이너는 `:ro` 로 실행하여 정적 리소스만 읽어 제공하도록 할 수 있음.