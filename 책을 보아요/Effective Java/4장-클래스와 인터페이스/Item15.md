# Item 15. 클래스와 멤버의 접근 권한을 최소화하라.
> ✔ 잘 설계된 컴포넌트는 모든 내부 구현을 외부 컴포넌트로부터 완벽히 숨겨, 구현과 API를 깔끔하게 분리한다.

이는 `정보 은닉` 혹은 `캡슐화`로 이어진다. </br>
요소의 접근성은 요소가 선언된 위치와 접근 제한자로 정해지는데, <u>접근 제한자를 제대로 활용하는 것이 정보 은닉의 핵심이다.</u>


## 정보 은닉의 장점
정보를 은닉함으로 시스템을 구성하는 `컴포넌트를 독립`시켜 개발, 테스트, 최적화, 적용, 분석, 수정을 개별적으로 할 수 있게 해준다.

1. 여러 컴포넌트를 병렬적으로 개발할 수 있어, 개발 속도를 높일 수 있다.
2. 각 컴포넌트를 빨리 파악할 수 있고, 디버깅 및 컴포넌트 교체가 수월하여 관리 비용을 낮출 수 있다. 
3. 성능을 높여주지는 않지만, 성능 최적화에 도움을 준다. </br>다른 컴포넌트에 영향을 주지 않고 해당 컴포넌트만 최적화할 수 있다.
4. 소프트웨어의 재사용성을 높인다. </br>외부에 의존하지 않는다면, 다른 환경에서도 유용하게 쓰일 수 있다.
5. 큰 시스템을 제작하는 난이도를 낮춘다. </br>시스템 전체가 완성되지 않은 상태에서도 개별 컴포넌트의 동작을 검증할 수 있기 때문이다.

> ✔ JLS = Java Language Specification

### + 접근 제한자
필드, 메서드, 중첩 클래스, 중첩 인터페이스에 부여할 수 있는 접근 수준 4가지.
* private : 톱레벨 클래스에서만 접근할 수 있다.
* package-private(default) : 패키지 안의 모든 클래스에서 접근할 수 있다.
* protected : package-private + 하위 클래스에서 접근할 수 있다.
* public : 모든 곳에서 접근할 수 있다.


## 👍 모든 클래스와 멤버의 접근성을 가능한 좁혀야 한다.
### 1. 패키지 외부에서 쓸 이유가 없다면 package-private로 선언하자.
한번 public으로 선언한 순간, 내부 구현이 아닌 API가 되어 하위 호환을 위해 계속 관리해야 한다.

### 2. 한 클래스에서만 사용하는 package-private 톱레벨 클래스/인터페이스는 이를 사용하는 클래스에 중첩시키자. </br>
중첩시 private static으로 중첩시키자.
톱레벨 클래스는 패키지의 모든 클래스에서 접근할 수 있지만, 중첩된 클래스는 바깥 클래스 하나에서만 접근할 수 있다. (🤔 왜 static이어야 하는지? item24)

### 3. public 클래스의 인스턴스 필드는 되도록 public이 아니어야 한다.
필드가 가변 객체를 참조하거나, final이 아닌 인스턴스 필드를  public으로 선언한다면 <u>필드의 값을 제한할 힘을 잃게 된다.</u> </br>
이 필드가 수정될 때 락 획득 같은 작업을 할 수 없게 되므로 public 가변 필드를 갖는 클래스는 일반적으로 thread-safe하지 않다. </br>

가변 객체를 참조하는 경우에는, 클래스의 객체는 참조하지 못하지만, 참조된 객체 자체는 수정될 수 있다. 이 필드를 반환하는 접근자 메서드도 제공하지 말자.
제공해야 한다면 아래의 두가지 방법을 제안한다.

1. public 배열을 private으로 바꾸고, `Collections.unmodifiableList`로 불변 리스트를 추가한다.
2. public 배열을 private으로 바꾸고, 반환하는 경우에는 그 복사본을 반환하자. (방어적 복사)

> ✔ 클라이언트가 무엇을 원하는지, 어느 반환 타입이 더 쓰기 편할지, 성능은 어느쪽ㅇ기 나을지 고민하고 정하자.

</br>
이 외에, 상수의 경우에는 `public static final` 필드로 공개해도 된다. (UNMODIFIABLE_URL 이런식으로 명명하면 된다.)


> ✔ 권한을 풀어주는 일을 자주 하게 된다면, 컴포넌트를 더 분해해야 하는 것은 아닌지 다시 고민해보자.

* Serializable을 구현한 경우, 필드가 의도치 않게 공개 API가 될 수 있다. (🤔 Item 86, 87)
* protected 멤버는 퍼블릭 클래스의 공개 API가 된다. 
> ✔ 공개 API가 된다는 것은, 하위 호환을 위해 계속 관리해야 하고 문서를 제공해야할 수도 있다는 말을 포함하도 있다. = 신중해야한다.

### 멤버 접근성을 좁히지 못하게 하는 제약.
* 상위 클래스의 메서드를 재정의 하는 경우에는, 접근 수준을 상위 클래스에서보다 좁게 설정할 수 없다. </br>
상위 클래스의 인스턴스는 하위 클래스의 인스턴스로 대체해 사용할 수 있어야 한다는 리스코프 치환 원칙을 지키기 위해 필요하다.

## 암묵적 접근 수준
자바9부터 모듈 시스템 개념이 도입되면서, 두 가지 암묵적 접근 수준이 추가되었다.
> 패키지 : 클래스들의 묶음 </br> 모듈 : 패키지의 묶음

모듈은 자신의 패키지 중에 공개할 것들을 module-info.java에 선언한다.
protected, public 멤버여도 선언되지 않았다면 모듈 외부에서 접근할 수 없다.

암묵적 접근 수준들은 public, protected 수준과 같은 효과가 모듈 내부로 한정되는 변종인 것.
이런 형태로 공유해야 하는 상황은 흔하지 않다.

모듈에 적용되는 새로운 두 접근 수준은 주의해야 한다.

만약 모듈의 jar 파일을 모듈 경로가 아닌 어플리케이션의 클래스패스에 결국 모듈이 없는 것처럼 행동.
ex) JDK 는 자바 라이브러리 에서 공개하지 않는 패키지들은 해당 모듈 밖에서 절대로 접근할 수 없다.

