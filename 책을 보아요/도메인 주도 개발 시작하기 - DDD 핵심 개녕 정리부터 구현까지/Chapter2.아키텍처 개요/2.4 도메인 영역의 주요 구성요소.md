```
👉 도메인 영역의 주요 요소로 엔티티, 벨류, 애그리거트, 리포지터리, 도메인 서비스.
👉 애그리거트는 관련된 엔티티와 벨류를 개념적으로 묶은 군집으로, 도메인 모델의 전체 구조를 이해하는데 도움이 됨.
👉 리포지터리는 애그리거트 단위로 도메인 객체를 저장하거나 조회함.
```

# 2.4 도메인 영역의 주요 구성 요소
- 엔티티
- 벨류
- 애그리거트
- 리포지터리
- 도메인 서비스

## 엔티티와 벨류
- [1.6 엔티티와 벨류](../Chapter1.%20도메인%20모델%20시작하기/1.6%20엔티티와%20벨류.md)
- 도메인 모델의 엔티티와 DB 의 엔티티를 비교해보자.
    - 도메인 모델의 엔티티는 데이터와 함께 **기능을 제공함.**
    - 도메인 모델의 엔티티는 벨류 객체를 사용하여 명확한 개념을 표현할 수 있음. DB 에서는 한 테이블에 저장하거나, 다른 테이블로 분리할 수 있는데 전자는 개념이 잘 드러나지 않음.

```java
// 도메인 모델 엔티티로 표현할 때
public class Order {
    OrderId id;
    Product product;
}

// DB 엔티티로 표현할 때
create table order (
    id ...,
    product_price ..., -- 개별 데이터만 드러내서 벨류를 완전히 표현하기 어려움.
    product_name ...,
)

```

## 애그리거트. Aggregate
- 연관된 엔티티와 벨류를 개념적으로 하나로 묶은 군집.
- 도메인 모델이 복잡해지면, 상위 수준에서 모델을 관리하고 보는 것이 전체 모델의 관계와 개별 모델을 이해하는데 도움이 됨. </br> 도메인 모델에서 전체 구조를 이해하는데 도움이 되는 것이 애그리거트임.
- 애그리거트 구성에 따라 복잡도/트랜잭션 범위가 달라질 수 있고, 구현 기술에 따라 구현에 제약이 생길 수 있음.

### 루트 엔티티
- 군집에 속한 객체를 관리하기 위한 루트 엔티티를 가짐.
- 애그리거트를 사용하는 곳에서는 루트가 제공하는 기능을 사용하고, 루트를 통해 애그리거트 내의 엔티티와 벨류에 간접적으로 접근할 수 있음.

## 리포지터리. Repository
- 도메인 모델의 영속성을 처리하고, DB 에서 엔티티를 객체를 조회하거나 저장.
- 엔티티와 벨류가 요구사항에서 도출되는 도메인 모델이라면, 레포지터리는 구현을 위한 도메인 모델.
- 애그리거트 단위로 도메인 객체를 저장하고 조회하는 기능을 함.

### 응용 서비스와 리포지터리
- 응용 서비스는 리포지터리를 통해 도메인 객체를 조회하거나 저장할 수 있음.
- 서비스가 관리하는 트랜잭션은 리포지터리 구현 기술에 영향을 받음.
- 응용 서비스와 리포지터리는 밀접한 관계를 가지고 있고, 리포지터리를 사용하는 주체가 응용 서비스이므로, 응용 서비스에서 필요한 기능을 제공해야함.


## 도메인 서비스. Domain Service
- 특정 엔티티에 속하지 않는 도메인 로직.
- 도메인 로직이 여러 엔티티와 벨류를 필요로 하는 경우, 도메인 서비스에서 로직을 구현함.